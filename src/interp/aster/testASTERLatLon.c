/**
 * ASTERLatLon.c
 * Authors: Yizhao Gao <ygao29@illinois.edu>
 * Date: {04/25/2017}
 */

#include <stdlib.h>
#include <stdio.h>
#include <sys/time.h>
#include "ASTERLatLon.h"

int main(int argc, char ** argv) {

	double inLat[121] = {
		40.67715865418453, 40.67664200676111, 40.676037102086546, 40.675343947930585, 40.674562553195926, 40.673692927917955, 40.672735083264286, 40.671689031534434, 40.670554786159265, 40.66933236170055, 40.66802177385039,
		40.60856871627761, 40.608053310566305, 40.60744985969752, 40.6067583714109, 40.60597885457474, 40.60511131918556, 40.60415577636782, 40.60311223837343, 40.60198071858131, 40.600761231496925, 40.599453792751675,
		40.53997795498243, 40.53946378847769, 40.53886178848131, 40.53817196270304, 40.537394319976876, 40.53652887026071, 40.53557562463601, 40.53453459530732, 40.53340579560189, 40.53218923996911, 40.53088494397999,
		40.47138637061814, 40.47087344082565, 40.470272888781494, 40.46958472216565, 40.468808949777994, 40.46794558153798, 40.46699462848426, 40.46595610277428, 40.464830017683816, 40.463616387606486, 40.4623152280532,
		40.402793963508444, 40.40228226794506, 40.401683160946035, 40.40099665016171, 40.40022274435799, 40.39936145341606, 40.39841278833201, 40.39737676121635, 40.396253385293676, 40.395042674902065, 40.39374464549263,
		40.3342007339816, 40.33369027017534, 40.33309260532738, 40.33240774705857, 40.33163570410103, 40.33077648629787, 40.329830104602756, 40.32879657107955, 40.32767589890186, 40.32646810235254, 40.32517319682314,
		40.26560668237042, 40.26509744786034, 40.26450122228234, 40.263818013227905, 40.26304782939553, 40.2621906805904, 40.261246577724016, 40.260215532813774, 40.25909755898257, 40.257892670458226, 40.256600882573075,
		40.19701180901227, 40.196503801348456, 40.19590901217218, 40.195227449045746, 40.19445912063415, 40.193604036704855, 40.19266220812738, 40.19163364687288, 40.190518366013755, 40.18931637972312, 40.1880277032743,
		40.12841611424904, 40.127909330992516, 40.127315975362585, 40.126636054892444, 40.12586957821381, 40.125016555056575, 40.12407699624846, 40.12305091371463, 40.121938320477206, 40.12073923065485, 40.11945365946218,
		40.05981959842723, 40.0593140371499, 40.058722112223656, 40.05804383115274, 40.057279202535696, 40.05642823606506, 40.05549094252696, 40.05446733380074, 40.053357422858525, 40.052161223764756, 40.05087875167563,
		39.99122226189783, 39.99071792018246, 39.99012742312993, 39.98945077821568, 39.988687994005254, 39.98783908015398, 39.9869040474066, 39.98588290759685, 39.984775673647114, 39.98358235956783, 39.98230298045707
	};

	double inLon[121] = {
		-86.45959533099254, -86.35864329581445, -86.25769410203429, -86.15674819670991, -86.0558060268072, -85.95486803918764, -85.85393468059581, -85.75300639764687, -85.65208363681404, -85.55116684441617, -85.45025646660515,
		-86.46014824365281, -86.35929948123164, -86.25845354916626, -86.15761089277775, -86.05677195729594, -85.95593718784689, -85.8551070294406, -85.75428192695854, -85.65346232514118, -85.5526486685757, -85.45184140168345,
		-86.46069925695778, -86.35995341258139, -86.25921038758142, -86.15847062555206, -86.05773456999691, -85.95700266431655, -85.8562753517962, -85.75555307559348, -85.65483627872598, -85.55412540405901, -85.4534208942932,
		-86.46124837827568, -86.3606050986076, -86.25996462739889, -86.15932740652674, -86.05869387777827, -85.95806448283831, -85.85743966327716, -85.75681986053837, -85.65620551592639, -85.55559707059443, -85.45499496553218,
		-86.46179561493288, -86.36125454800452, -86.26071627868042, -86.16018124713044, -86.05964989343502, -85.95912265757299, -85.85859997940942, -85.75808229868345, -85.65757005499614, -85.5570636877983, -85.45656363637836,
		-86.46234097421421, -86.36190176941706, -86.26146535143057, -86.161032158727, -86.06060262968968, -85.96017720260112, -85.85975631563082, -85.75934040682317, -85.65892991408549, -85.55852527517581, -85.45812692769086,
		-86.46288446336318, -86.36254677144117, -86.26221185559733, -86.16188015261584, -86.06155209919264, -85.96122813192343, -85.86090868729177, -85.7605942016569, -85.6602851112419, -85.55998185212161, -85.45968486021067,
		-86.46342608958233, -86.36318956262414, -86.26295580107231, -86.16272524003249, -86.06249831452271, -85.9622754594615, -85.86205710965586, -85.76184369978948, -85.66163566441072, -85.56143343792071, -85.46123745456147,
		-86.46396586003345, -86.36383015146494, -86.26369719769122, -86.16356743214891, -86.06344128818763, -85.96331919905812, -85.8632015979004, -85.76308891773196, -85.66298159143591, -85.56288005174913, -85.46278473125044,
		-86.46450378183792, -86.36446854641454, -86.26443605523423, -86.16440674007401, -86.06438103262448, -85.96435936447799, -85.86434216711699, -85.76432987190215, -85.66432291006072, -85.56432171267467, -85.464326710669,
		-86.46503986207692, -86.36510475587623, -86.26517238342635, -86.16524317485404, -86.0653175602002, -85.9653959694082, -85.86547883231216, -85.76556657862534, -85.66565963792836, -85.56575843965766, -85.46586341309371
	};

//The second test cut across +180/-180 longitude
/*	double inLat[121] = {
	-15.33625688735907, -15.33729712035207, -15.338311122548136, -15.339298885135484, -15.340260399528923, -15.341195657370038, -15.342104650527391, -15.342987371096672, -15.343843811400898, -15.344673963990566, -15.345477821643811,
-15.401501587703745, -15.4025464581311, -15.403564980865957, -15.404557147053941, -15.405522948068354, -15.406462375510385, -15.407375421209283, -15.408262077222524, -15.409122335836019, -15.40995618956424, -15.41076363115041,
-15.466745847767022, -15.467795358409424, -15.468818404394248, -15.469814976824463, -15.470785067031796, -15.471728666576972, -15.472645767249857, -15.473536361069666, -15.474400440285118, -15.47523799737462, -15.47604902504643,
-15.531989665798754, -15.533043819451082, -15.534071391410894, -15.535072372738412, -15.536046754723742, -15.536994528887059, -15.537915686978797, -15.53881022097983, -15.539678123101643, -15.54051938578651, -15.54133400170765,
-15.597233040050183, -15.598291839521545, -15.599323940195227, -15.600329333088641, -15.601308009450197, -15.60225996075946, -15.603185178727358, -15.60408365529637, -15.604955382640672, -15.605800353166355, -15.606618559511546,
-15.66247596877392, -15.663539416887675, -15.66457604902801, -15.665585856169464, -15.666568829518662, -15.667524960514502, -15.668454240828348, -15.669356662364201, -15.67023221725889, -15.671080897882243, -15.671902696837241,
-15.727718450223962, -15.728786549817768, -15.729827716191476, -15.73084194027668, -15.73182921323816, -15.732789526474079, -15.733722871616152, -15.734629240529864, -15.735508625314615, -15.73636101830392, -15.737186412065551,
-15.79296048265567, -15.794033236581503, -15.795078939969272, -15.79609758370755, -15.797089158919206, -15.798053656961585, -15.798991069426714, -15.799901388141471, -15.80078460516778, -15.801640712802769, -15.802469703578955,
-15.858202064325823, -15.85927947545002, -15.860329718646536, -15.861352784760856, -15.862348664873855, -15.863317350302012, -15.864258832597576, -15.865173103548774, -15.86606015517997, -15.866919979751865, -15.867752569761649,
-15.923443193492579, -15.924525264695868, -15.925580050509849, -15.926607541736846, -15.927607729415687, -15.928580604821883, -15.929526159467862, -15.93044438510312, -15.931335273714414, -15.932198817525942, -15.933035008999507,
-15.988683868415485, -15.989770602593017, -15.990829933847255, -15.99186185293728, -15.992866350859781, -15.993843418849274, -15.994793048378268, -15.995715231157472, -15.996609959135968, -15.997477224501393, -15.998317019680103
	};

	double inLon[121] = {
	179.93365787633113, -179.98972914477142, -179.91311040948253, -179.83648606470385, -179.75985625739605, -179.68322113457742, -179.6065808433222, -179.52993553075908, -179.4532853440695, -179.37663043048636, -179.29997093729213,
179.93270302787312, -179.9906602240368, -179.91401771110696, -179.83736958045327, -179.76071597925082, -179.6840570547326, -179.60739295418762, -179.53072382495958, -179.45404981444509, -179.37737107009232, -179.30068773939934,
179.93174362619172, -179.991595743264, -179.91492933938517, -179.83825730950304, -179.7615798010084, -179.68489696135003, -179.60820893803293, -179.53151587861691, -179.45481793071508, -179.37811524199202, -179.30140796016246,
179.93077966457852, -179.99253570899575, -179.9158453006939, -179.83914925806383, -179.7624477287132, -179.6857408603077, -179.6090288005696, -179.53231169727604, -179.45558969825763, -179.37886295139668, -179.3021316046258,
179.92981113628815, -179.99348012781056, -179.91676560144487, -179.8400454323804, -179.7633197684428, -179.686588757516, -179.6098525475406, -179.53311128651234, -179.45636512248043, -179.37961420354617, -179.30285867786125,
179.9288380345384, -179.9944290063232, -179.91769024808502, -179.84094583873178, -179.76419592630822, -179.6874406589177, -179.61068018472037, -179.53391465193167, -179.45714420882084, -179.3803690037092, -179.30358918496867,
179.9278603525098, -179.9953823511845, -179.91861924709656, -179.84185048343127, -179.7650762084538, -179.68829657048803, -179.61151171791488, -179.53472179917074, -179.45792696274597, -179.38112735718317, -179.30432313107576,
179.92687808334583, -179.99634016908158, -179.91955260499705, -179.84275937282675, -179.76596062105747, -179.6891564982349, -179.6123471529619, -179.53553273389696, -179.4587133897528, -179.38188926929453, -179.30506052133822,
179.92589122015247, -179.9973024667381, -179.9204903283395, -179.84367251330056, -179.76684917033083, -179.6900204481989, -179.61318649573084, -179.53634746180856, -179.45950349536824, -179.38265474539867, -179.3058013609398,
179.92489975599838, -179.99826925091412, -179.92143242371264, -179.84458991126982, -179.7677418625192, -179.69088842645354, -179.6140297521233, -179.53716598863488, -179.46029728514924, -179.38342379088013, -179.30654565509255,
179.92390368391452, -179.99924052840643, -179.92237889774088, -179.84551157318643, -179.76863870390181, -179.69176043910517, -179.61487692807256, -179.5379883201362, -179.46109476468294, -179.38419641115266, -179.30729340903667
	};
*/
	int nRow = 847;
	int nCol = 949;

	double * cLat;
	double * cLon;

	if(NULL == (cLat = (double *)malloc(sizeof(double) * nRow * nCol))) {
		printf("Out of memeory for cLat\n");
		exit(1);
	}
	if(NULL == (cLon = (double *)malloc(sizeof(double) * nRow * nCol))) {
		printf("Out of memeory for cLon\n");
		exit(1);
	}
/*	
	printf("lat,lon\n");
	for(int i = 0; i < 121; i++) {
		printf("%lf,%lf\n", inLat[i], inLon[i]);
	}
*/
	struct timeval tBegin;
	struct timeval tEnd;
	
	gettimeofday(&tBegin, NULL);
	
	asterLatLonPlanar(inLat, inLon, cLat, cLon, nRow, nCol);

	gettimeofday(&tEnd, NULL);
	printf("Time:\t%lfms\n", ((&tEnd)->tv_sec - (&tBegin)->tv_sec) * 1000 + (double)((&tEnd)->tv_usec - (&tBegin)->tv_usec) / 1000);


/*
	printf("lat,lon\n");
	for(int i = 0; i < nRow * nCol; i++) {
		printf("%lf,%lf\n", cLat[i], cLon[i]);
	}
*/
	free(cLat);
	free(cLon);

	return 0;
}
